@page "/"
@inject ContextMenuService ContextMenuService
@inject DialogService DialogService
@using System
@using System.IO
@using ParaglidingFlightLogWeb.Components.Subs
@using Microsoft.AspNetCore.Hosting
@using Microsoft.Extensions.Logging
@inject IWebHostEnvironment Environment
@inject ILogger<Index> _logger
@using ParaglidingFlightLogWeb.ViewModels


@rendermode InteractiveServer

<PageTitle>Paraglidier Flight Log</PageTitle>

<RadzenText TextStyle="TextStyle.H3" Text="Welcome on the Paraglider Flight Log" />

<AuthorizeView>
    <Authorized>
        <RadzenRow>
            <RadzenColumn SizeSM="6">
                <RadzenCard>
                    <RadzenText TextStyle="TextStyle.H4" Text="Interesting facts" />
                    
                    <RadzenRow>
                        <RadzenColumn>
                            <MyNumericIndicator Format="F0" Label="Number of sites during the last year" Value="@FlightStatisticService.LastYearSiteCount" />
                        </RadzenColumn>
                        <RadzenColumn>
                            <MyTextIndicator Label="Glider with the oldest last check" Text="@($"{FlightStatisticService.OldestCheckUsedGlider?.FullName} ({FlightStatisticService.OldestCheckUsedGlider?.LastCheckDateTime.ToString("d")} with {FlightStatisticService.OldestCheckUsedGlider?.FlightTimeSinceLastCheck} flight hours)")" />
                        </RadzenColumn>
                    </RadzenRow>
                </RadzenCard>
                <RadzenCard>
                    <RadzenText TextStyle="TextStyle.H4" Text="Flights of the year" />
                    <p>Coming soon</p>
                </RadzenCard>
                <RadzenCard>
                    <RadzenText TextStyle="TextStyle.H4" Text="Something graphical" />
                    <p>Coming soon</p>
                </RadzenCard>
            </RadzenColumn>
            <RadzenColumn SizeSM="6">
                <RadzenCard>
                    <RadzenText TextStyle="TextStyle.H4" Text="Trigger some memories" />
                    @if (_flightToRemember is not null)
                    {
                        <RadzenRow>
                            <RadzenColumn >
                                <MyTextIndicator Label="Flight date" Text="@_flightToRemember.TakeOffDateTime.ToString("d")" />
                                <MyTextIndicator Label="Glider" Text="@_flightToRemember.GliderName" />
                                <MyPhysicalValueIndicator Label="Max Height" Value="@_flightToRemember.MaxHeight" UnitSymbol="m" Format="F0" />
                                <MyPhysicalValueIndicator Label="Trace Length" Value="@_flightToRemember.TraceLength" UnitSymbol="km" Format="F2" />
                                <MyPhysicalValueIndicator Label="Max Climb (8s)" Value="@_flightToRemember.MaxClimb" UnitSymbol="m/s" Format="F1" />
                                <MyPhysicalValueIndicator Label="Max Sink (8s)" Value="@_flightToRemember.MaxSink" UnitSymbol="m/s" Format="F1" />
                            </RadzenColumn>
                            <RadzenColumn >
                                @if (_flightToRemember.XcScore is not null)
                                {
                                    <MyNumericIndicator Label="Score" Value="@_flightToRemember.XcScore.Points" />
                                    <MyTextIndicator Label="Type of flight" Text="@_flightToRemember.XcScore.Type" />
                                }
                            </RadzenColumn>
                        </RadzenRow>
                        <RadzenRow>
                            <RadzenColumn SizeSM="6">
                                <MyTextIndicator Label="Comment" Text="@_flightToRemember.Comment" Bold=false />
                            </RadzenColumn>
                            <RadzenColumn SizeSM="6">
                                <ShowFlightOnMap FlightToShow="@_flightToRemember" Height="350"/>
                            </RadzenColumn>
                        </RadzenRow>

                            

                    }
                </RadzenCard>
            </RadzenColumn>
        </RadzenRow>
    </Authorized>
    <NotAuthorized>
        <RadzenText TextStyle="TextStyle.Body1">
            You are currently not log in please <RadzenLink Path="/Account/Login">log in</RadzenLink>
        </RadzenText>
    </NotAuthorized>
</AuthorizeView>

